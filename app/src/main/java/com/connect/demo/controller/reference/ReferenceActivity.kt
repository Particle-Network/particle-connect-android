package com.connect.demo.controller.reference

import android.annotation.SuppressLint
import android.os.Bundle
import android.text.method.ScrollingMovementMethod
import android.util.Log
import androidx.lifecycle.lifecycleScope
import com.blankj.utilcode.util.GsonUtils
import com.blankj.utilcode.util.LogUtils
import com.connect.common.*
import com.connect.common.eip4361.Eip4361Message
import com.connect.common.eip4361.Web3jSignatureVerifier
import com.connect.common.model.*
import com.connect.common.utils.PrefUtils
import com.connect.demo.R
import com.connect.demo.base.BaseActivity
import com.connect.demo.databinding.ActivityReferenceBinding
import com.connect.demo.model.WalletAccount
import com.connect.demo.utils.ChainUtils
import com.connect.demo.utils.MockManger
import com.connect.demo.utils.StreamUtils
import com.connect.demo.utils.toast
import com.particle.api.evm
import com.particle.api.service.data.ContractParams
import com.particle.base.ParticleNetwork
import com.particle.base.model.ChainType
import com.particle.base.model.EVMTransactionUtil
import com.particle.base.model.ITxData
import com.particle.base.model.LegacyTransactionData
import com.particle.connect.ParticleConnect
import kotlinx.coroutines.launch
import network.particle.chains.NativeCurrency

class ReferenceActivity : BaseActivity<ActivityReferenceBinding>(R.layout.activity_reference) {

    private lateinit var walletAccount: WalletAccount


    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        walletAccount = MockManger.walletAccount!!
        setupUI()
    }

    override fun onDestroy() {
        super.onDestroy()
        MockManger.walletAccount = null
    }

    @SuppressLint("SetTextI18n")
    private fun setupUI() {
        binding.toolbar.setNavigationOnClickListener {
            finish()
        }
        binding.toolbar.title = walletAccount.name
        binding.toolbar.inflateMenu(R.menu.delete_action)
        binding.toolbar.setOnMenuItemClickListener {
            walletAccount.connectAdapter.disconnect(walletAccount.account.publicAddress,
                object : DisconnectCallback {
                    override fun onDisconnected() {
                        finish()
                    }

                    override fun onError(error: ConnectError) {
                        toast(error.message)
                    }

                })
            true
        }

        binding.address.text = "Address: ${walletAccount.account.publicAddress}"
        binding.signAndSendTransaction.setOnClickListener {
            if (walletAccount.connectAdapter.connected(walletAccount.account.publicAddress)) {
                lifecycleScope.launch {
                    try {
                        signAndSendTransaction()
                    } catch (e: Exception) {
                        e.printStackTrace()
                    }
                }
            } else {
                connectWallet()
            }
        }
        binding.signTransaction.setOnClickListener {
            if (walletAccount.connectAdapter.connected(walletAccount.account.publicAddress)) {
                lifecycleScope.launch {
                    try {
                        signTransaction()
                    } catch (e: Exception) {
                        e.printStackTrace()
                    }
                }
            } else {
                connectWallet()
            }
        }

        binding.signAllTransactions.setOnClickListener {
            if (walletAccount.connectAdapter.connected(walletAccount.account.publicAddress)) {
                lifecycleScope.launch {
                    try {
                        signAllTransactions()
                    } catch (e: Exception) {
                        e.printStackTrace()
                    }
                }
            } else {
                connectWallet()
            }
        }
        binding.signMessage.setOnClickListener {
            if (walletAccount.connectAdapter.connected(walletAccount.account.publicAddress)) {
                signMessage()
            } else {
                connectWallet()
            }
        }
        binding.signTypedData.setOnClickListener {
            if (walletAccount.connectAdapter.connected(walletAccount.account.publicAddress)) {
                signTypedData()
            } else {
                connectWallet()
            }
        }
        binding.request.movementMethod = ScrollingMovementMethod.getInstance()
        binding.result.movementMethod = ScrollingMovementMethod.getInstance()
        binding.signMessageVerify.setOnClickListener {
            val message = createMessage()
            if (walletAccount.connectAdapter.connected(walletAccount.account.publicAddress)) {
                login(message)
            } else {
                connectWallet()
            }

        }

        binding.writeContract.setOnClickListener {
            lifecycleScope.launch {
                val params = ContractParams.customAbiEncodeFunctionCall(
                    contractAddress = "0xd000f000aa1f8accbd5815056ea32a54777b2fc4",
                    methodName = "mint",
                    params = listOf("1")
                )
                val txData: ITxData? = ParticleNetwork.evm.writeContract(
                    walletAccount.account.publicAddress,
                    params
                )
                walletAccount.connectAdapter.signAndSendTransaction(
                    walletAccount.account.publicAddress,
                    txData!!.serialize(),
                    object : TransactionCallback {
                        override fun onTransaction(transactionId: String?) {
                            binding.result.text = transactionId ?: ""
                            toast("signAndSendTransaction success")
                        }

                        override fun onError(error: ConnectError) {

                            Log.e("signAndSendTransaction", error.message)
                            toast(error.message)
                        }
                    })
            }

        }
    }


    private fun connectWallet() {
        walletAccount.connectAdapter.connect(null, object : ConnectCallback {
            override fun onConnected(account: Account) {
                LogUtils.d("onConnected: $account")
                if (!account.publicAddress.equals(walletAccount.account.publicAddress, true)) {
                    toast("Please connect correct account")
                }

            }

            override fun onError(error: ConnectError) {
                toast(error.message)
            }
        })
    }

//    val testTransactionStr ="7b22616374696f6e223a226e6f726d616c222c22636861696e4964223a2230783261222c2264617461223a223078613037313264363830303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303031222c2266726f6d223a22307835303466383364363530323966623630376663616134336562643062373032326162313631623063222c226761734c6576656c223a22222c226761734c696d6974223a2230783230633835222c226d6178466565506572476173223a2230783737333539343063222c226d61785072696f72697479466565506572476173223a2230783737333539343030222c226e6f6e6365223a22307830222c2272223a6e756c6c2c2273223a6e756c6c2c22746f223a22307864303030663030306161316638616363626435383135303536656133326135343737376232666334222c2274797065223a22307832222c2276223a6e756c6c2c2276616c7565223a6e756c6c7d"

    private suspend fun signAndSendTransaction() {
        val transaction = MockManger.mockCreateTransaction(walletAccount.account.publicAddress)
        binding.request.text = GsonUtils.toJson(transaction)
        binding.result.text = ""
        val trans =
            "7B2266726F6D223A22307832363438636645393765333333343533303044623831353436373033343762303836343335373062222C22746F223A22307833323643393737453665666338344535313262423943333066373645333063313630654430364642222C2264617461223A22307861393035396362623030303030303030303030303030303030303030303030306163366438313138323939386561356331393661343432346561366162323530633765623137356230303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303233383666323666633130303030222C226761734C696D6974223A22307839353133222C226761735072696365223A6E756C6C2C2276616C7565223A22307830222C226E6F6E6365223A6E756C6C2C2274797065223A22307832222C22636861696E4964223A2235222C226D61785072696F72697479466565506572476173223A2230783737333539343030222C226D6178466565506572476173223A2230783737333539343138227D"
        val trans2 =
            "0x7b22616374696f6e223a226e6f726d616c222c22636861696e4964223a22307831222c2264617461223a223078363130313430363034303532333438303135363230303030313235373630303038306664356235303630343035313830363034303031363034303532383036303139383135323630323030313766343436313666363936653637343336663664366437353665363937343739343336663663366336353633373436393666366530303030303030303030303030303831353235303630343035313830363034303031363034303532383036303031383135323630323030313766333130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353235303630343035313830363034303031363034303532383036303139383135323630323030313766343436313666363936653637343336663664366437353665363937343739343336663663366336353633373436393666366530303030303030303030303030303831353235303630343035313830363034303031363034303532383036303033383135323630323030313766343434333433303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353235303831363030303930383035313930363032303031393036323030303130333932393139303632303030333034353635623530383036303031393038303531393036303230303139303632303030313163393239313930363230303033303435363562353035303530363230303031336636323030303133333632303030316661363032303162363032303163353635623632303030323032363032303162363032303163353635623630303038323830353139303630323030313230393035303630303038323830353139303630323030313230393035303630303037663862373363336336396262386665336435313265636334636637353963633739323339663762313739623066666163616139613735643532326233393430306639303530383236306530383138313532353035303831363130313030383138313532353035303436363061303831383135323530353036323030303161383831383438343632303030326338363032303162363032303163353635623630383038313831353235303530333037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363630633038313733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363036303162383135323530353038303631303132303831383135323530353035303530353035303530363230303034663135363562363030303333393035303930353635623630303036303037363030303930353439303631303130303061393030343733666666666666666666666666666666666666666666666666666666666666666666666666666666663136393035303831363030373630303036313031303030613831353438313733666666666666666666666666666666666666666666666666666666666666666666666666666666663032313931363930383337336666666666666666666666666666666666666666666666666666666666666666666666666666666631363032313739303535353038313733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383137336666666666666666666666666666666666666666666666666666666666666666666666666666666631363766386265303037396335333136353931343133343463643166643061346632383431393439376639373232613364616166653362343138366636623634353765303630343035313630343035313830393130333930613335303530353635623630303038333833383334363330363034303531363032303031363230303032653539353934393339323931393036323030303365373536356236303430353136303230383138333033303338313532393036303430353238303531393036303230303132303930353039333932353035303530353635623832383035343632303030333132393036323030303438633536356239303630303035323630323036303030323039303630316630313630323039303034383130313932383236323030303333363537363030303835353536323030303338323536356238323630316631303632303030333531353738303531363066663139313638333830303131373835353536323030303338323536356238323830303136303031303138353535383231353632303030333832353739313832303135623832383131313135363230303033383135373832353138323535393136303230303139313930363030313031393036323030303336343536356235623530393035303632303030333931393139303632303030333935353635623530393035363562356238303832313131353632303030336230353736303030383136303030393035353530363030313031363230303033393635363562353039303536356236323030303362663831363230303034343435363562383235323530353035363562363230303033643038313632303030343538353635623832353235303530353635623632303030336531383136323030303438323536356238323532353035303536356236303030363061303832303139303530363230303033666536303030383330313838363230303033633535363562363230303034306436303230383330313837363230303033633535363562363230303034316336303430383330313836363230303033633535363562363230303034326236303630383330313835363230303033643635363562363230303034336136303830383330313834363230303033623435363562393639353530353035303530353035303536356236303030363230303034353138323632303030343632353635623930353039313930353035363562363030303831393035303931393035303536356236303030373366666666666666666666666666666666666666666666666666666666666666666666666666666666383231363930353039313930353035363562363030303831393035303931393035303536356236303030363030323832303439303530363030313832313638303632303030346135353736303766383231363931353035623630323038323130383131343135363230303034626335373632303030346262363230303034633235363562356235303931393035303536356237663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303232363030343532363032343630303066643562363038303531363061303531363063303531363036303163363065303531363130313030353136313031323035313631353335313632303030353434363030303339363030303631316162363031353236303030363131616638303135323630303036313161643730313532363030303631316130633031353236303030363131613632303135323630303036313161386230313532363135333531363030306633666536303830363034303532363030343336313036313031633235373630303033353630653031633830363336333532323131653131363130306637353738303633396162323465623031313631303039353537383036336333636461353230313136313030363435373830363363336364613532303134363130363635353738303633633837623536646431343631303638653537383036336539383565396335313436313036636235373830363366326664653338623134363130373038353736313031633235363562383036333961623234656230313436313035616435373830363361323263623436353134363130356561353738303633616633303935343231343631303631333537383036336238386434666465313436313036336335373631303163323536356238303633376563656265303031313631303064313537383036333765636562653030313436313034646435373830363338646135636235623134363130353161353738303633386535333965386331343631303534353537383036333935643839623431313436313035383235373631303163323536356238303633363335323231316531343631303434633537383036333730613038323331313436313034383935373830363337313530313861363134363130346336353736313031633235363562383036333430643039376333313136313031363435373830363334613965386163373131363130313365353738303633346139653861633731343631303361313537383036333538376364653165313436313033626435373830363335633139613935633134363130336661353738303633356435613932666231343631303432333537363130316332353635623830363334306430393763333134363130333236353738303633343238343265306531343631303334663537383036333432393636633638313436313033373835373631303163323536356238303633303935656137623331313631303161303537383036333039356561376233313436313032366335373830363332336238373264643134363130323935353738303633333634346535313531343631303262653537383036333361343662316138313436313032653935373631303163323536356238303633303166666339613731343631303163373537383036333036666464653033313436313032303435373830363330383138313266633134363130323266353735623630303038306664356233343830313536313031643335373630303038306664356235303631303165653630303438303336303338313031393036313031653939313930363133633439353635623631303733313536356236303430353136313031666239313930363134333439353635623630343035313830393130333930663335623334383031353631303231303537363030303830666435623530363130323139363130383133353635623630343035313631303232363931393036313434356335363562363034303531383039313033393066333562333438303135363130323362353736303030383066643562353036313032353636303034383033363033383130313930363130323531393139303631336339623536356236313038613535363562363034303531363130323633393139303631343262393536356236303430353138303931303339306633356233343830313536313032373835373630303038306664356235303631303239333630303438303336303338313031393036313032386539313930363133623562353635623631303865623536356230303562333438303135363130326131353736303030383066643562353036313032626336303034383033363033383130313930363130326237393139303631336135353536356236313061303335363562303035623334383031353631303263613537363030303830666435623530363130326433363130613633353635623630343035313631303265303931393036313433363435363562363034303531383039313033393066333562333438303135363130326635353736303030383066643562353036313033313036303034383033363033383130313930363130333062393139303631336235623536356236313061373235363562363034303531363130333164393139303631343739653536356236303430353138303931303339306633356233343830313536313033333235373630303038306664356235303631303334643630303438303336303338313031393036313033343839313930363133396630353635623631306163643536356230303562333438303135363130333562353736303030383066643562353036313033373636303034383033363033383130313930363130333731393139303631336135353536356236313062333835363562303035623334383031353631303338343537363030303830666435623530363130333966363030343830333630333831303139303631303339613931393036313363396235363562363130623538353635623030356236313033626236303034383033363033383130313930363130336236393139303631336235623536356236313062623435363562303035623334383031353631303363393537363030303830666435623530363130336534363030343830333630333831303139303631303364663931393036313339663035363562363130643331353635623630343035313631303366313931393036313432623935363562363034303531383039313033393066333562333438303135363130343036353736303030383066643562353036313034323136303034383033363033383130313930363130343163393139303631333966303536356236313064396135363562303035623334383031353631303432663537363030303830666435623530363130343461363030343830333630333831303139303631303434353931393036313339663035363562363130646234353635623030356233343830313536313034353835373630303038306664356235303631303437333630303438303336303338313031393036313034366539313930363133633962353635623631306636623536356236303430353136313034383039313930363134326239353635623630343035313830393130333930663335623334383031353631303439353537363030303830666435623530363130346230363030343830333630333831303139303631303461623931393036313339663035363562363131303164353635623630343035313631303462643931393036313437396535363562363034303531383039313033393066333562333438303135363130346432353736303030383066643562353036313034646236313130643535363562303035623334383031353631303465393537363030303830666435623530363130353034363030343830333630333831303139303631303466663931393036313339663035363562363131306539353635623630343035313631303531313931393036313437396535363562363034303531383039313033393066333562333438303135363130353236353736303030383066643562353036313035326636313131333935363562363034303531363130353363393139303631343262393536356236303430353138303931303339306633356233343830313536313035353135373630303038306664356235303631303536633630303438303336303338313031393036313035363739313930363133633962353635623631313136333536356236303430353136313035373939313930363134373965353635623630343035313830393130333930663335623334383031353631303538653537363030303830666435623530363130353937363131316332353635623630343035313631303561343931393036313434356335363562363034303531383039313033393066333562333438303135363130356239353736303030383066643562353036313035643436303034383033363033383130313930363130356366393139303631333966303536356236313132353435363562363034303531363130356531393139303631343739653536356236303430353138303931303339306633356233343830313536313035663635373630303038306664356235303631303631313630303438303336303338313031393036313036306339313930363133623166353635623631313261343536356230303562333438303135363130363166353736303030383066643562353036313036336136303034383033363033383130313930363130363335393139303631333966303536356236313132626135363562303035623334383031353631303634383537363030303830666435623530363130363633363030343830333630333831303139303631303635653931393036313361613435363562363131333036353635623030356233343830313536313036373135373630303038306664356235303631303638633630303438303336303338313031393036313036383739313930363133623937353635623631313336383536356230303562333438303135363130363961353736303030383066643562353036313036623536303034383033363033383130313930363130366230393139303631336339623536356236313134366335363562363034303531363130366332393139303631343435633536356236303430353138303931303339306633356233343830313536313036643735373630303038306664356235303631303666323630303438303336303338313031393036313036656439313930363133613139353635623631313437653536356236303430353136313036666639313930363134333439353635623630343035313830393130333930663335623334383031353631303731343537363030303830666435623530363130373266363030343830333630333831303139303631303732613931393036313339663035363562363131353132353635623030356236303030376638306163353863643030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030376266666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663139313638323762666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666631393136313438303631303766633537353037663562356531333966303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303037626666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666313931363832376266666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663139313631343562383036313038306335373530363130383062383236313135393635363562356239303530393139303530353635623630363036303030383035343631303832323930363134613732353635623830363031663031363032303830393130343032363032303031363034303531393038313031363034303532383039323931393038313831353236303230303138323830353436313038346539303631346137323536356238303135363130383962353738303630316631303631303837303537363130313030383038333534303430323833353239313630323030313931363130383962353635623832303139313930363030303532363032303630303032303930356238313534383135323930363030313031393036303230303138303833313136313038376535373832393030333630316631363832303139313562353035303530353035303930353039303536356236303030363130386230383236313136303035363562363030343630303038333831353236303230303139303831353236303230303136303030323036303030393035343930363130313030306139303034373366666666666666666666666666666666666666666666666666666666666666666666666666666666313639303530393139303530353635623630303036313038663638323631306636623536356239303530383037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313631343135363130393637353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363130393565393036313437316535363562363034303531383039313033393066643562383037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363631303938363631313634623536356237336666666666666666666666666666666666666666666666666666666666666666666666666666666631363134383036313039623535373530363130396234383136313039616636313136346235363562363131343765353635623562363130396634353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363130396562393036313436376535363562363034303531383039313033393066643562363130396665383338333631313635333536356235303530353035363562363130613134363130613065363131363462353635623832363131373063353635623631306135333537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631306134613930363134373765353635623630343035313830393130333930666435623631306135653833383338333631313761313536356235303530353035363562363030303631306136643631316130383536356239303530393035363562363030303631306163353832363030393630303038363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313532363032303031393038313532363032303031363030303230363131623232393039313930363366666666666666663136353635623930353039323931353035303536356236313061643536313163633635363562363030303631306165313630306336313164343435363562393035303631306165643630306336313164353235363562363130616637383238323631316436383536356236313062333438313631306230333631316438363536356236303065363130623065383536313164613635363562363034303531363032303031363130623230393339323931393036313432343635363562363034303531363032303831383330333033383135323930363034303532363131663533353635623530353035363562363130623533383338333833363034303531383036303230303136303430353238303630303038313532353036313133303635363562353035303530353635623631306236393631306236333631313634623536356238323631313730633536356236313062613835373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313062396639303631343737653536356236303430353138303931303339306664356236313062623138313631316663373536356235303536356236303066353438313631306263303631316664333536356236313062636139313930363134383930353635623131313536313063306235373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313063303239303631343733653536356236303430353138303931303339306664356236303030356238313831313031353631306338393537363030303631306332323630306336313164343435363562393035303631306332653630306336313164353235363562363130633338383438323631316436383536356236313063373538313631306334343631316438363536356236303065363130633466383536313164613635363562363034303531363032303031363130633631393339323931393036313432343635363562363034303531363032303831383330333033383135323930363034303532363131663533353635623530383038303631306338313930363134616435353635623931353035303631306330653536356235303631306364363630313136303030393035343930363130313030306139303034373366666666666666666666666666666666666666666666666666666666666666666666666666666666313636373064653062366233613736343030303036303130353433343631306363373931393036313439313735363562363130636431393139303631343865363536356236313166653435363562363130643264363031323630303039303534393036313031303030613930303437336666666666666666666666666666666666666666666666666666666666666666666666666666666631363637306465306236623361373634303030303630313035343334363130643133393139303631343931373536356236313064316439313930363134386536353635623334363130643238393139303631343937313536356236313166653435363562353035303536356236303030363030383630303038333733666666666666666666666666666666666666666666666666666666666666666666666666666666663136373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313532363032303031393038313532363032303031363030303230363030303930353439303631303130303061393030343733666666666666666666666666666666666666666666666666666666666666666666666666666666663136393035303931393035303536356236303030363130646134363131363462353635623930353036313064623038313833363132303266353635623530353035363562363130646263363131636336353635623630303037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363831373366666666666666666666666666666666666666666666666666666666666666666666666666666666313631343135363130653434353736313064663936313136346235363562373366666666666666666666666666666666666666666666666666666666666666666666666666666666313636313038666334373930383131353032393036303430353136303030363034303531383038333033383138353838383866313933353035303530353031353830313536313065336535373364363030303830336533643630303066643562353036313066363835363562363030303831393035303830373366666666666666666666666666666666666666666666666666666666666666666666666666666666313636336139303539636262363130653664363131363462353635623833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313636333730613038323331333036303430353138323633666666666666666631363630653031623831353236303034303136313065613639313930363134326239353635623630323036303430353138303833303338313836383033623135383031353631306562653537363030303830666435623530356166613135383031353631306564323537336436303030383033653364363030306664356235303530353035303630343035313364363031663139363031663832303131363832303138303630343035323530383130313930363130656636393139303631336363343536356236303430353138333633666666666666666631363630653031623831353236303034303136313066313339323931393036313433323035363562363032303630343035313830383330333831363030303837383033623135383031353631306632643537363030303830666435623530356166313135383031353631306634313537336436303030383033653364363030306664356235303530353035303630343035313364363031663139363031663832303131363832303138303630343035323530383130313930363130663635393139303631336332303536356235303530356235303536356236303030383036303032363030303834383135323630323030313930383135323630323030313630303032303630303039303534393036313031303030613930303437336666666666666666666666666666666666666666666666666666666666666666666666666666666631363930353036303030373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313431353631313031343537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631313030623930363134366665353635623630343035313830393130333930666435623830393135303530393139303530353635623630303038303733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383237336666666666666666666666666666666666666666666666666666666666666666666666666666666631363134313536313130386535373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313130383539303631343564653536356236303430353138303931303339306664356236303033363030303833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637336666666666666666666666666666666666666666666666666666666666666666666666666666666631363831353236303230303139303831353236303230303136303030323035343930353039313930353035363562363131306464363131636336353635623631313065373630303036313231343335363562353635623630303036313131333236303062363030303834373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637336666666666666666666666666666666666666666666666666666666666666666666666666666666631363831353236303230303139303831353236303230303136303030323036313164343435363562393035303931393035303536356236303030363030373630303039303534393036313031303030613930303437336666666666666666666666666666666666666666666666666666666666666666666666666666666631363930353039303536356236303030343338323130363131316137353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363131313965393036313436336535363562363034303531383039313033393066643562363131316262383236303061363131623232393039313930363366666666666666663136353635623930353039313930353035363562363036303630303138303534363131316431393036313461373235363562383036303166303136303230383039313034303236303230303136303430353139303831303136303430353238303932393139303831383135323630323030313832383035343631313166643930363134613732353635623830313536313132346135373830363031663130363131323166353736313031303038303833353430343032383335323931363032303031393136313132346135363562383230313931393036303030353236303230363030303230393035623831353438313532393036303031303139303630323030313830383331313631313232643537383239303033363031663136383230313931356235303530353035303530393035303930353635623630303036313132396436303039363030303834373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637336666666666666666666666666666666666666666666666666666666666666666666666666666666631363831353236303230303139303831353236303230303136303030323036313232303935363562393035303931393035303536356236313132623636313132616636313136346235363562383338333631323263613536356235303530353635623631313263323631316363363536356238303630313236303030363130313030306138313534383137336666666666666666666666666666666666666666666666666666666666666666666666666666666630323139313639303833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313630323137393035353530353035363562363131333137363131333131363131363462353635623833363131373063353635623631313335363537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631313334643930363134373765353635623630343035313830393130333930666435623631313336323834383438343834363132343337353635623530353035303530353635623833343231313135363131336162353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363131336132393036313435666535363562363034303531383039313033393066643562363030303631313430643631313430353766653438333239303537626664303364353565343962353437313332653339636666643963313832306164376239643463353330373639313432356431356164663839383938393630343035313630323030313631313365613934393339323931393036313433376635363562363034303531363032303831383330333033383135323930363034303532383035313930363032303031323036313234393335363562383538353835363132346164353635623930353036313134313838313631323464383536356238363134363131343539353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363131343530393036313434396535363562363034303531383039313033393066643562363131343633383138383631323032663536356235303530353035303530353035303536356236303630363131343737383236313235333635363562393035303931393035303536356236303030363030353630303038343733666666666666666666666666666666666666666666666666666666666666666666666666666666663136373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313532363032303031393038313532363032303031363030303230363030303833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637336666666666666666666666666666666666666666666666666666666666666666666666666666666631363831353236303230303139303831353236303230303136303030323036303030393035343930363130313030306139303034363066663136393035303932393135303530353635623631313531613631316363363536356236303030373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313431353631313538613537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631313538313930363134346665353635623630343035313830393130333930666435623631313539333831363132313433353635623530353635623630303037663031666663396137303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303037626666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666313931363832376266666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663139313631343930353039313930353035363562363131363039383136313236343935363562363131363438353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363131363366393036313436666535363562363034303531383039313033393066643562353035363562363030303333393035303930353635623831363030343630303038333831353236303230303139303831353236303230303136303030323036303030363130313030306138313534383137336666666666666666666666666666666666666666666666666666666666666666666666666666666630323139313639303833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313630323137393035353530383038323733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363131366336383336313066366235363562373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637663863356265316535656265633764356264313466373134323764316538346633646430333134633066376232323931653562323030616338633763336239323536303430353136303430353138303931303339306134353035303536356236303030383036313137313838333631306636623536356239303530383037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363834373366666666666666666666666666666666666666666666666666666666666666666666666666666666313631343830363131373561353735303631313735393831383536313134376535363562356238303631313739383537353038333733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363131373830383436313038613535363562373366666666666666666666666666666666666666666666666666666666666666666666666666666666313631343562393135303530393239313530353035363562383237336666666666666666666666666666666666666666666666666666666666666666666666666666666631363631313763313832363130663662353635623733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313436313138313735373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313138306539303631343531653536356236303430353138303931303339306664356236303030373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638323733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313431353631313838373537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631313837653930363134353565353635623630343035313830393130333930666435623631313839323833383338333631323662353536356236313138396436303030383236313136353335363562363030313630303336303030383537336666666666666666666666666666666666666666666666666666666666666666666666666666666631363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383135323630323030313930383135323630323030313630303032303630303038323832353436313138656439313930363134393731353635623932353035303831393035353530363030313630303336303030383437336666666666666666666666666666666666666666666666666666666666666666666666666666666631363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383135323630323030313930383135323630323030313630303032303630303038323832353436313139343439313930363134383930353635623932353035303831393035353530383136303032363030303833383135323630323030313930383135323630323030313630303032303630303036313031303030613831353438313733666666666666666666666666666666666666666666666666666666666666666666666666666666663032313931363930383337336666666666666666666666666666666666666666666666666666666666666666666666666666666631363032313739303535353038303832373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638343733666666666666666666666666666666666666666666666666666666666666666666666666666666663136376664646632353261643162653263383962363963326230363866633337386461613935326261376631363363346131313632386635356134646635323362336566363034303531363034303531383039313033393061343631316130333833383338333631323662613536356235303530353035363562363030303766303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303733666666666666666666666666666666666666666666666666666666666666666666666666666666663136333037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363134383031353631316138343537353037663030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303034363134356231353631316162313537376630303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030393035303631316231663536356236313162316337663030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303037663030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303037663030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036313236636135363562393035303562393035363562363030303433383231303631316236363537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631316235643930363134356265353635623630343035313830393130333930666435623630303038333630303030313830353439303530393035303630303035623831383131303135363131633130353736303030363131623839383238343631323730343536356239303530383438363630303030313832383135343831313036313162633835373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630333236303034353236303234363030306664356239303630303035323630323036303030323030313630303030313630303039303534393036313031303030613930303436336666666666666666313636336666666666666666313631313135363131626661353738303932353036313163306135363562363030313831363131633037393139303631343839303536356239313530356235303631316237353536356236303030383231343631316339623537383436303030303136303031383336313163323939313930363134393731353635623831353438313130363131633630353737663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303332363030343532363032343630303066643562393036303030353236303230363030303230303136303030303136303034393035343930363130313030306139303034376266666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663136363131633965353635623630303035623762666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666631363932353035303530393239313530353035363562363131636365363131363462353635623733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363131636563363131313339353635623733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313436313164343235373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313164333939303631343662653536356236303430353138303931303339306664356235363562363030303831363030303031353439303530393139303530353635623630303138313630303030313630303038323832353430313932353035303831393035353530353035363562363131643832383238323630343035313830363032303031363034303532383036303030383135323530363132373261353635623530353035363562363036303630343035313830363036303031363034303532383036303261383135323630323030313631353266323630326139313339393035303930353635623630363036303030383231343135363131646565353736303430353138303630343030313630343035323830363030313831353236303230303137663330303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532353039303530363131663465353635623630303038323930353036303030356236303030383231343631316532303537383038303631316530393930363134616435353635623931353035303630306138323631316531393931393036313438653635363562393135303631316466363536356236303030383136376666666666666666666666666666666638313131313536313165363235373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630343136303034353236303234363030306664356236303430353139303830383235323830363031663031363031663139313636303230303138323031363034303532383031353631316539343537383136303230303136303031383230323830333638333337383038323031393135303530393035303562353039303530356236303030383531343631316634373537363030313832363131656164393139303631343937313536356239313530363030613835363131656263393139303631346232383536356236303330363131656338393139303631343839303536356236306638316238313833383135313831313036313166303435373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630333236303034353236303234363030306664356236303230303130313930376566666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663139313639303831363030303161393035333530363030613835363131663430393139303631343865363536356239343530363131653938353635623830393335303530353035303562393139303530353635623631316635633832363132363439353635623631316639623537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631316639323930363134363165353635623630343035313830393130333930666435623830363030363630303038343831353236303230303139303831353236303230303136303030323039303830353139303630323030313930363131666332393239313930363133376538353635623530353035303536356236313166643038313631323738353536356235303536356236303030363131666466363030613631323230393536356239303530393035363562383137336666666666666666666666666666666666666666666666666666666666666666666666666666666631363631303866633832393038313135303239303630343035313630303036303430353138303833303338313835383838386631393335303530353035303135383031353631323032613537336436303030383033653364363030306664356235303530353035363562363030303631323033613833363130643331353635623930353038313630303836303030383537336666666666666666666666666666666666666666666666666666666666666666666666666666666631363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383135323630323030313930383135323630323030313630303032303630303036313031303030613831353438313733666666666666666666666666666666666666666666666666666666666666666666666666666666663032313931363930383337336666666666666666666666666666666666666666666666666666666666666666666666666666666631363032313739303535353038313733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383137336666666666666666666666666666666666666666666666666666666666666666666666666666666631363834373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637663331333465386132653664393765393239613765353430313165613534383564376431393664643566306261346434656639353830336538653366633235376636303430353136303430353138303931303339306134363132313365383138333631323133393836363132376438353635623631323765613536356235303530353035363562363030303630303736303030393035343930363130313030306139303034373366666666666666666666666666666666666666666666666666666666666666666666666666666666313639303530383136303037363030303631303130303061383135343831373366666666666666666666666666666666666666666666666666666666666666666666666666666666303231393136393038333733666666666666666666666666666666666666666666666666666666666666666666666666666666663136303231373930353535303831373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313733666666666666666666666666666666666666666666666666666666666666666666666666666666663136376638626530303739633533313635393134313334346364316664306134663238343139343937663937323261336461616665336234313836663662363435376530363034303531363034303531383039313033393061333530353035363562363030303830383236303030303138303534393035303930353036303030383131343631323261313537383236303030303136303031383236313232326639313930363134393731353635623831353438313130363132323636353737663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303332363030343532363032343630303066643562393036303030353236303230363030303230303136303030303136303034393035343930363130313030306139303034376266666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663136363132326134353635623630303035623762666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666631363931353035303931393035303536356238313733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383337336666666666666666666666666666666666666666666666666666666666666666666666666666666631363134313536313233333935373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313233333039303631343537653536356236303430353138303931303339306664356238303630303536303030383537336666666666666666666666666666666666666666666666666666666666666666666666666666666631363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383135323630323030313930383135323630323030313630303032303630303038343733666666666666666666666666666666666666666666666666666666666666666666666666666666663136373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313532363032303031393038313532363032303031363030303230363030303631303130303061383135343831363066663032313931363930383331353135303231373930353535303831373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638333733666666666666666666666666666666666666666666666666666666666666666666666666666666663136376631373330376561623339616236313037653838393938343561643364353962643936353366323030663232303932303438396361326235393337363936633331383336303430353136313234326139313930363134333439353635623630343035313830393130333930613335303530353035363562363132343432383438343834363131376131353635623631323434653834383438343834363132396637353635623631323438643537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631323438343930363134346465353635623630343035313830393130333930666435623530353035303530353635623630303036313234613636313234613036313161303835363562383336313262386535363562393035303931393035303536356236303030383036303030363132346265383738373837383736313262633135363562393135303931353036313234636238313631326363653536356238313932353035303530393439333530353035303530353635623630303038303630306236303030383437336666666666666666666666666666666666666666666666666666666666666666666666666666666631363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383135323630323030313930383135323630323030313630303032303930353036313235323538313631316434343536356239313530363132353330383136313164353235363562353039313930353035363562363036303631323534313832363131363030353635623630303036303036363030303834383135323630323030313930383135323630323030313630303032303830353436313235363139303631346137323536356238303630316630313630323038303931303430323630323030313630343035313930383130313630343035323830393239313930383138313532363032303031383238303534363132353864393036313461373235363562383031353631323564613537383036303166313036313235616635373631303130303830383335343034303238333532393136303230303139313631323564613536356238323031393139303630303035323630323036303030323039303562383135343831353239303630303130313930363032303031383038333131363132356264353738323930303336303166313638323031393135623530353035303530353039303530363030303631323565623631316438363536356239303530363030303831353131343135363132363031353738313932353035303530363132363434353635623630303038323531313131353631323633363537383038323630343035313630323030313631323631653932393139303631343232323536356236303430353136303230383138333033303338313532393036303430353239323530353035303631323634343536356236313236336638343631333031663536356239323530353035303562393139303530353635623630303038303733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363030323630303038343831353236303230303139303831353236303230303136303030323036303030393035343930363130313030306139303034373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637336666666666666666666666666666666666666666666666666666666666666666666666666666666631363134313539303530393139303530353635623530353035303536356236313236633538333833383336313330383735363562353035303530353635623630303038333833383334363330363034303531363032303031363132366535393539343933393239313930363134336334353635623630343035313630323038313833303330333831353239303630343035323830353139303630323030313230393035303933393235303530353035363562363030303630303238323834313836313237313539313930363134386536353635623832383431363631323732323931393036313438393035363562393035303932393135303530353635623631323733343833383336313330613335363562363132373431363030303834383438343631323966373536356236313237383035373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313237373739303631343464653536356236303430353138303931303339306664356235303530353035363562363132373865383136313332376435363562363030303630303636303030383338313532363032303031393038313532363032303031363030303230383035343631323761653930363134613732353635623930353031343631323764353537363030363630303038323831353236303230303139303831353236303230303136303030323036303030363132376434393139303631333836653536356235623530353635623630303036313237653338323631313031643536356239303530393139303530353635623831373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638333733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313431353830313536313238323635373530363030303831313135623135363132396632353736303030373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638333733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313436313239306535373630303038303631323862373631333339613834363030393630303038393733666666666666666666666666666666666666666666666666666666666666666666666666666666663136373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638313532363032303031393038313532363032303031363030303230363133336230393039323931393036336666666666666666313635363562393135303931353038343733666666666666666666666666666666666666666666666666666666666666666666666666666666663136376664656332626163646432663035623539646533346461396235323364666638626534326535653338653831386338326664623062616537373433383761373234383338333630343035313631323930333932393139303631343762393536356236303430353138303931303339306132353035303562363030303733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383237336666666666666666666666666666666666666666666666666666666666666666666666666666666631363134363132396631353736303030383036313239396136313333646538343630303936303030383837336666666666666666666666666666666666666666666666666666666666666666666666666666666631363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383135323630323030313930383135323630323030313630303032303631333362303930393239313930363366666666666666663136353635623931353039313530383337336666666666666666666666666666666666666666666666666666666666666666666666666666666631363766646563326261636464326630356235396465333464613962353233646666386265343265356533386538313863383266646230626165373734333837613732343833383336303430353136313239653639323931393036313437623935363562363034303531383039313033393061323530353035623562353035303530353635623630303036313261313838343733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363133336634353635623135363132623831353738333733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363331353062376130323631326134313631313634623536356238373836383636303430353138353633666666666666666631363630653031623831353236303034303136313261363339343933393239313930363134326434353635623630323036303430353138303833303338313630303038373830336231353830313536313261376435373630303038306664356235303561663139323530353035303830313536313261616535373530363034303531336436303166313936303166383230313136383230313830363034303532353038313031393036313261616239313930363133633732353635623630303135623631326233313537336438303630303038313134363132616465353736303430353139313530363031663139363033663364303131363832303136303430353233643832353233643630303036303230383430313365363132616533353635623630363039313530356235303630303038313531313431353631326232393537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631326232303930363134346465353635623630343035313830393130333930666435623830353138313630323030316664356236333135306237613032363065303162376266666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663139313638313762666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666631393136313439313530353036313262383635363562363030313930353035623934393335303530353035303536356236303030383238323630343035313630323030313631326261333932393139303631343238323536356236303430353136303230383138333033303338313532393036303430353238303531393036303230303132303930353039323931353035303536356236303030383037663766666666666666666666666666666666666666666666666666666666666666356435373665373335376134353031646466653932663436363831623230613038333630303031633131313536313262666335373630303036303033393135303931353036313263633535363562363031623835363066663136313431353830313536313263313435373530363031633835363066663136313431353562313536313263323635373630303036303034393135303931353036313263633535363562363030303630303138373837383738373630343035313630303038313532363032303031363034303532363034303531363132633462393439333932393139303631343431373536356236303230363034303531363032303831303339303830383430333930383535616661313538303135363132633664353733643630303038303365336436303030666435623530353035303630323036303430353130333531393035303630303037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363831373366666666666666666666666666666666666666666666666666666666666666666666666666666666313631343135363132636263353736303030363030313932353039323530353036313263633535363562383036303030393235303932353035303562393435303934393235303530353035363562363030303630303438313131313536313264303835373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356238313630303438313131313536313264343135373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356231343135363132643463353736313330316335363562363030313630303438313131313536313264383635373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356238313630303438313131313536313264626635373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356231343135363132653030353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363132646637393036313434376535363562363034303531383039313033393066643562363030323630303438313131313536313265336135373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356238313630303438313131313536313265373335373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356231343135363132656234353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363132656162393036313434626535363562363034303531383039313033393066643562363030333630303438313131313536313265656535373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356238313630303438313131313536313266323735373766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323136303034353236303234363030306664356231343135363132663638353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363132663566393036313435396535363562363034303531383039313033393066643562363030343830383131313135363132666131353737663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303231363030343532363032343630303066643562383136303034383131313135363132666461353737663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303231363030343532363032343630303066643562313431353631333031623537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631333031323930363134363565353635623630343035313830393130333930666435623562353035363562363036303631333032613832363131363030353635623630303036313330333436313164383635363562393035303630303038313531313136313330353435373630343035313830363032303031363034303532383036303030383135323530363133303766353635623830363133303565383436313164613635363562363034303531363032303031363133303666393239313930363134323232353635623630343035313630323038313833303330333831353239303630343035323562393135303530393139303530353635623631333039333833383336303031363133343137353635623631333039653833383338333631333464373536356235303530353035363562363030303733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383237336666666666666666666666666666666666666666666666666666666666666666666666666666666631363134313536313331313335373630343035313766303863333739613030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303831353236303034303136313331306139303631343639653536356236303430353138303931303339306664356236313331316338313631323634393536356231353631333135633537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631333135333930363134353365353635623630343035313830393130333930666435623631333136383630303038333833363132366235353635623630303136303033363030303834373366666666666666666666666666666666666666666666666666666666666666666666666666666666313637336666666666666666666666666666666666666666666666666666666666666666666666666666666631363831353236303230303139303831353236303230303136303030323036303030383238323534363133316238393139303631343839303536356239323530353038313930353535303831363030323630303038333831353236303230303139303831353236303230303136303030323036303030363130313030306138313534383137336666666666666666666666666666666666666666666666666666666666666666666666666666666630323139313639303833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313630323137393035353530383038323733666666666666666666666666666666666666666666666666666666666666666666666666666666663136363030303733666666666666666666666666666666666666666666666666666666666666666666666666666666663136376664646632353261643162653263383962363963326230363866633337386461613935326261376631363363346131313632386635356134646635323362336566363034303531363034303531383039313033393061343631333237393630303038333833363132366261353635623530353035363562363030303631333238383832363130663662353635623930353036313332393638313630303038343631323662353536356236313332613136303030383336313136353335363562363030313630303336303030383337336666666666666666666666666666666666666666666666666666666666666666666666666666666631363733666666666666666666666666666666666666666666666666666666666666666666666666666666663136383135323630323030313930383135323630323030313630303032303630303038323832353436313332663139313930363134393731353635623932353035303831393035353530363030323630303038333831353236303230303139303831353236303230303136303030323036303030363130313030306138313534393037336666666666666666666666666666666666666666666666666666666666666666666666666666666630323139313639303535383136303030373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638323733666666666666666666666666666666666666666666666666666666666666666666666666666666663136376664646632353261643162653263383962363963326230363866633337386461613935326261376631363363346131313632386635356134646635323362336566363034303531363034303531383039313033393061343631333339363831363030303834363132366261353635623530353035363562363030303831383336313333613839313930363134393731353635623930353039323931353035303536356236303030383036313333643238353631333363643631333363333838363132323039353635623836383836336666666666666666313635363562363133346463353635623931353039313530393335303933393135303530353635623630303038313833363133336563393139303631343839303536356239303530393239313530353035363562363030303830383237336666666666666666666666666666666666666666666666666666666666666666666666666666666631363362313139303530393139303530353635623630303037336666666666666666666666666666666666666666666666666666666666666666666666666666666631363833373366666666666666666666666666666666666666666666666666666666666666666666666666666666313631343135363133343637353736313334363436313333646538323630306136313333623039303932393139303633666666666666666631363536356235303530356236303030373366666666666666666666666666666666666666666666666666666666666666666666666666666666313638323733666666666666666666666666666666666666666666666666666666666666666666666666666666663136313431353631333462373537363133346234363133333961383236303061363133336230393039323931393036336666666666666666313635363562353035303562363133346432363133346333383436313064333135363562363133346363383436313064333135363562383336313237656135363562353035303530353635623530353035303536356236303030383036303030383436303030303138303534393035303930353036303030363133346636383636313232303935363562393035303630303038323131383031353631333537323537353034333836363030303031363030313834363133353135393139303631343937313536356238313534383131303631333534633537376634653438376237313030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030363030303532363033323630303435323630323436303030666435623930363030303532363032303630303032303031363030303031363030303930353439303631303130303061393030343633666666666666666631363633666666666666666631363134356231353631333632383537363133353830383536313337326135363562383636303030303136303031383436313335393139313930363134393731353635623831353438313130363133356338353737663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303332363030343532363032343630303066643562393036303030353236303230363030303230303136303030303136303034363130313030306138313534383137626666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666303231393136393038333762666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666631363032313739303535353036313337316235363562383536303030303136303430353138303630343030313630343035323830363133363430343336313337393535363562363366666666666666663136383135323630323030313631333635343838363133373261353635623762666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666631363831353235303930383036303031383135343031383038323535383039313530353036303031393030333930363030303532363032303630303032303031363030303930393139303931393039313530363030303832303135313831363030303031363030303631303130303061383135343831363366666666666666663032313931363930383336336666666666666666313630323137393035353530363032303832303135313831363030303031363030343631303130303061383135343831376266666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663032313931363930383337626666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666313630323137393035353530353035303562383038353933353039333530353035303932353039323930353035363562363030303762666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666638303136383231313135363133373864353736303430353137663038633337396130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303038313532363030343031363133373834393036313436646535363562363034303531383039313033393066643562383139303530393139303530353635623630303036336666666666666666383031363832313131353631333765303537363034303531376630386333373961303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383135323630303430313631333764373930363134373565353635623630343035313830393130333930666435623831393035303931393035303536356238323830353436313337663439303631346137323536356239303630303035323630323036303030323039303630316630313630323039303034383130313932383236313338313635373630303038353535363133383564353635623832363031663130363133383266353738303531363066663139313638333830303131373835353536313338356435363562383238303031363030313031383535353832313536313338356435373931383230313562383238313131313536313338356335373832353138323535393136303230303139313930363030313031393036313338343135363562356235303930353036313338366139313930363133386165353635623530393035363562353038303534363133383761393036313461373235363562363030303832353538303630316631303631333838633537353036313338616235363562363031663031363032303930303439303630303035323630323036303030323039303831303139303631333861613931393036313338616535363562356235303536356235623830383231313135363133386337353736303030383136303030393035353530363030313031363133386166353635623530393035363562363030303631333864653631333864393834363134383037353635623631343765323536356239303530383238313532363032303831303138343834383430313131313536313338663635373630303038306664356236313339303138343832383536313461333035363562353039333932353035303530353635623630303038313335393035303631333931383831363135323637353635623932393135303530353635623630303038313335393035303631333932643831363135323765353635623932393135303530353635623630303038313531393035303631333934323831363135323765353635623932393135303530353635623630303038313335393035303631333935373831363135323935353635623932393135303530353635623630303038313335393035303631333936633831363135326163353635623932393135303530353635623630303038313531393035303631333938313831363135326163353635623932393135303530353635623630303038323630316638333031313236313339393835373630303038306664356238313335363133396138383438323630323038363031363133386362353635623931353035303932393135303530353635623630303038313335393035303631333963303831363135326333353635623932393135303530353635623630303038313531393035303631333964353831363135326333353635623932393135303530353635623630303038313335393035303631333965613831363135326461353635623932393135303530353635623630303036303230383238343033313231353631336130323537363030303830666435623630303036313361313038343832383530313631333930393536356239313530353039323931353035303536356236303030383036303430383338353033313231353631336132633537363030303830666435623630303036313361336138353832383630313631333930393536356239323530353036303230363133613462383538323836303136313339303935363562393135303530393235303932393035303536356236303030383036303030363036303834383630333132313536313361366135373630303038306664356236303030363133613738383638323837303136313339303935363562393335303530363032303631336138393836383238373031363133393039353635623932353035303630343036313361396138363832383730313631333962313536356239313530353039323530393235303932353635623630303038303630303038303630383038353837303331323135363133616261353736303030383066643562363030303631336163383837383238383031363133393039353635623934353035303630323036313361643938373832383830313631333930393536356239333530353036303430363133616561383738323838303136313339623135363562393235303530363036303835303133353637666666666666666666666666666666663831313131353631336230373537363030303830666435623631336231333837383238383031363133393837353635623931353035303932393539313934353039323530353635623630303038303630343038333835303331323135363133623332353736303030383066643562363030303631336234303835383238363031363133393039353635623932353035303630323036313362353138353832383630313631333931653536356239313530353039323530393239303530353635623630303038303630343038333835303331323135363133623665353736303030383066643562363030303631336237633835383238363031363133393039353635623932353035303630323036313362386438353832383630313631333962313536356239313530353039323530393239303530353635623630303038303630303038303630303038303630633038373839303331323135363133626230353736303030383066643562363030303631336262653839383238613031363133393039353635623936353035303630323036313362636638393832386130313631333962313536356239353530353036303430363133626530383938323861303136313339623135363562393435303530363036303631336266313839383238613031363133396462353635623933353035303630383036313363303238393832386130313631333934383536356239323530353036306130363133633133383938323861303136313339343835363562393135303530393239353530393239353530393239353536356236303030363032303832383430333132313536313363333235373630303038306664356236303030363133633430383438323835303136313339333335363562393135303530393239313530353035363562363030303630323038323834303331323135363133633562353736303030383066643562363030303631336336393834383238353031363133393564353635623931353035303932393135303530353635623630303036303230383238343033313231353631336338343537363030303830666435623630303036313363393238343832383530313631333937323536356239313530353039323931353035303536356236303030363032303832383430333132313536313363616435373630303038306664356236303030363133636262383438323835303136313339623135363562393135303530393239313530353035363562363030303630323038323834303331323135363133636436353736303030383066643562363030303631336365343834383238353031363133396336353635623931353035303932393135303530353635623631336366363831363134396135353635623832353235303530353635623631336430353831363134396237353635623832353235303530353635623631336431343831363134396333353635623832353235303530353635623631336432623631336432363832363134396333353635623631346231653536356238323532353035303536356236303030363133643363383236313438346435363562363133643436383138353631343836333536356239333530363133643536383138353630323038363031363134613366353635623631336435663831363134633135353635623834303139313530353039323931353035303536356236303030363133643735383236313438353835363562363133643766383138353631343837343536356239333530363133643866383138353630323038363031363134613366353635623631336439383831363134633135353635623834303139313530353039323931353035303536356236303030363133646165383236313438353835363562363133646238383138353631343838353536356239333530363133646338383138353630323038363031363134613366353635623830383430313931353035303932393135303530353635623630303038313534363133646531383136313461373235363562363133646562383138363631343838353536356239343530363030313832313636303030383131343631336530363537363030313831313436313365313735373631336534613536356236306666313938333136383635323831383630313933353036313365346135363562363133653230383536313438333835363562363030303562383338313130313536313365343235373831353438313839303135323630303138323031393135303630323038313031393035303631336532333536356238333838303139353530353035303562353035303530393239313530353035363562363030303631336536303630313838333631343837343536356239313530363133653662383236313463323635363562363032303832303139303530393139303530353635623630303036313365383336303134383336313438373435363562393135303631336538653832363134633466353635623630323038323031393035303931393035303536356236303030363133656136363031663833363134383734353635623931353036313365623138323631346337383536356236303230383230313930353039313930353035363562363030303631336563393630333238333631343837343536356239313530363133656434383236313463613135363562363034303832303139303530393139303530353635623630303036313365656336303236383336313438373435363562393135303631336566373832363134636630353635623630343038323031393035303931393035303536356236303030363133663066363032353833363134383734353635623931353036313366316138323631346433663536356236303430383230313930353039313930353035363562363030303631336633323630316338333631343837343536356239313530363133663364383236313464386535363562363032303832303139303530393139303530353635623630303036313366353536303032383336313438383535363562393135303631336636303832363134646237353635623630303238323031393035303931393035303536356236303030363133663738363032343833363134383734353635623931353036313366383338323631346465303536356236303430383230313930353039313930353035363562363030303631336639623630313938333631343837343536356239313530363133666136383236313465326635363562363032303832303139303530393139303530353635623630303036313366626536303232383336313438373435363562393135303631336663393832363134653538353635623630343038323031393035303931393035303536356236303030363133666531363032303833363134383734353635623931353036313366656338323631346561373536356236303230383230313930353039313930353035363562363030303631343030343630323938333631343837343536356239313530363134303066383236313465643035363562363034303832303139303530393139303530353635623630303036313430323736303138383336313438373435363562393135303631343033323832363134663166353635623630323038323031393035303931393035303536356236303030363134303461363032653833363134383734353635623931353036313430353538323631346634383536356236303430383230313930353039313930353035363562363030303631343036643630316138333631343837343536356239313530363134303738383236313466393735363562363032303832303139303530393139303530353635623630303036313430393036303232383336313438373435363562393135303631343039623832363134666330353635623630343038323031393035303931393035303536356236303030363134306233363033653833363134383734353635623931353036313430626538323631353030663536356236303430383230313930353039313930353035363562363030303631343064363630323038333631343837343536356239313530363134306531383236313530356535363562363032303832303139303530393139303530353635623630303036313430663936303230383336313438373435363562393135303631343130343832363135303837353635623630323038323031393035303931393035303536356236303030363134313163363032373833363134383734353635623931353036313431323738323631353062303536356236303430383230313930353039313930353035363562363030303631343133663630313838333631343837343536356239313530363134313461383236313530666635363562363032303832303139303530393139303530353635623630303036313431363236303231383336313438373435363562393135303631343136643832363135313238353635623630343038323031393035303931393035303536356236303030363134313835363031623833363134383734353635623931353036313431393038323631353137373536356236303230383230313930353039313930353035363562363030303631343161383630323638333631343837343536356239313530363134316233383236313531613035363562363034303832303139303530393139303530353635623630303036313431636236303265383336313438373435363562393135303631343164363832363135316566353635623630343038323031393035303931393035303536356236303030363134316565363030313833363134383835353635623931353036313431663938323631353233653536356236303031383230313930353039313930353035363562363134323064383136313461313935363562383235323530353035363562363134323163383136313461323335363562383235323530353035363562363030303631343232653832383536313364613335363562393135303631343233613832383436313364613335363562393135303831393035303933393235303530353035363562363030303631343235323832383636313364613335363562393135303631343235653832383536313364643435363562393135303631343236393832363134316531353635623931353036313432373538323834363133646133353635623931353038313930353039343933353035303530353035363562363030303631343238643832363133663438353635623931353036313432393938323835363133643161353635623630323038323031393135303631343261393832383436313364316135363562363032303832303139313530383139303530393339323530353035303536356236303030363032303832303139303530363134326365363030303833303138343631336365643536356239323931353035303536356236303030363038303832303139303530363134326539363030303833303138373631336365643536356236313432663636303230383330313836363133636564353635623631343330333630343038333031383536313432303435363562383138313033363036303833303135323631343331353831383436313364333135363562393035303935393435303530353035303530353635623630303036303430383230313930353036313433333536303030383330313835363133636564353635623631343334323630323038333031383436313432303435363562393339323530353035303536356236303030363032303832303139303530363134333565363030303833303138343631336366633536356239323931353035303536356236303030363032303832303139303530363134333739363030303833303138343631336430623536356239323931353035303536356236303030363038303832303139303530363134333934363030303833303138373631336430623536356236313433613136303230383330313836363133636564353635623631343361653630343038333031383536313432303435363562363134336262363036303833303138343631343230343536356239353934353035303530353035303536356236303030363061303832303139303530363134336439363030303833303138383631336430623536356236313433653636303230383330313837363133643062353635623631343366333630343038333031383636313364306235363562363134343030363036303833303138353631343230343536356236313434306436303830383330313834363133636564353635623936393535303530353035303530353035363562363030303630383038323031393035303631343432633630303038333031383736313364306235363562363134343339363032303833303138363631343231333536356236313434343636303430383330313835363133643062353635623631343435333630363038333031383436313364306235363562393539343530353035303530353035363562363030303630323038323031393035303831383130333630303038333031353236313434373638313834363133643661353635623930353039323931353035303536356236303030363032303832303139303530383138313033363030303833303135323631343439373831363133653533353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313434623738313631336537363536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134346437383136313365393935363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343466373831363133656263353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313435313738313631336564663536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134353337383136313366303235363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343535373831363133663235353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313435373738313631336636623536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134353937383136313366386535363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343562373831363133666231353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313435643738313631336664343536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134356637383136313366663735363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343631373831363134303161353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313436333738313631343033643536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134363537383136313430363035363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343637373831363134303833353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313436393738313631343061363536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134366237383136313430633935363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343664373831363134306563353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313436663738313631343130663536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134373137383136313431333235363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343733373831363134313535353635623930353039313930353035363562363030303630323038323031393035303831383130333630303038333031353236313437353738313631343137383536356239303530393139303530353635623630303036303230383230313930353038313831303336303030383330313532363134373737383136313431396235363562393035303931393035303536356236303030363032303832303139303530383138313033363030303833303135323631343739373831363134316265353635623930353039313930353035363562363030303630323038323031393035303631343762333630303038333031383436313432303435363562393239313530353035363562363030303630343038323031393035303631343763653630303038333031383536313432303435363562363134376462363032303833303138343631343230343536356239333932353035303530353635623630303036313437656336313437666435363562393035303631343766383832383236313461613435363562393139303530353635623630303036303430353139303530393035363562363030303637666666666666666666666666666666663832313131353631343832323537363134383231363134626536353635623562363134383262383236313463313535363562393035303630323038313031393035303931393035303536356236303030383139303530383136303030353236303230363030303230393035303931393035303536356236303030383135313930353039313930353035363562363030303831353139303530393139303530353635623630303038323832353236303230383230313930353039323931353035303536356236303030383238323532363032303832303139303530393239313530353035363562363030303831393035303932393135303530353635623630303036313438396238323631346131393536356239313530363134386136383336313461313935363562393235303832376666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666303338323131313536313438646235373631343864613631346235393536356235623832383230313930353039323931353035303536356236303030363134386631383236313461313935363562393135303631343866633833363134613139353635623932353038323631343930633537363134393062363134623838353635623562383238323034393035303932393135303530353635623630303036313439323238323631346131393536356239313530363134393264383336313461313935363562393235303831376666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666303438333131383231353135313631353631343936363537363134393635363134623539353635623562383238323032393035303932393135303530353635623630303036313439376338323631346131393536356239313530363134393837383336313461313935363562393235303832383231303135363134393961353736313439393936313462353935363562356238323832303339303530393239313530353035363562363030303631343962303832363134396639353635623930353039313930353035363562363030303831313531353930353039313930353035363562363030303831393035303931393035303536356236303030376666666666666666663030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030383231363930353039313930353035363562363030303733666666666666666666666666666666666666666666666666666666666666666666666666666666663832313639303530393139303530353635623630303038313930353039313930353035363562363030303630666638323136393035303931393035303536356238323831383333373630303038333833303135323530353035303536356236303030356238333831313031353631346135643537383038323031353138313834303135323630323038313031393035303631346134323536356238333831313131353631346136633537363030303834383430313532356235303530353035303536356236303030363030323832303439303530363030313832313638303631346138613537363037663832313639313530356236303230383231303831313431353631346139653537363134613964363134626237353635623562353039313930353035363562363134616164383236313463313535363562383130313831383131303637666666666666666666666666666666663832313131373135363134616363353736313461636236313462653635363562356238303630343035323530353035303536356236303030363134616530383236313461313935363562393135303766666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666663832313431353631346231333537363134623132363134623539353635623562363030313832303139303530393139303530353635623630303038313930353039313930353035363562363030303631346233333832363134613139353635623931353036313462336538333631346131393536356239323530383236313462346535373631346234643631346238383536356235623832383230363930353039323931353035303536356237663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303131363030343532363032343630303066643562376634653438376237313030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030363030303532363031323630303435323630323436303030666435623766346534383762373130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303035323630323236303034353236303234363030306664356237663465343837623731303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030353236303431363030343532363032343630303066643562363030303630316631393630316638333031313639303530393139303530353635623766343534333434353334313361323036393665373636313663363936343230373336393637366536313734373537323635303030303030303030303030303030303630303038323031353235303536356237663536366637343635373333613230363936653736363136633639363432303665366636653633363530303030303030303030303030303030303030303030303036303030383230313532353035363562376634353433343435333431336132303639366537363631366336393634323037333639363736653631373437353732363532303663363536653637373436383030363030303832303135323530353635623766343535323433333733323331336132303734373236313665373336363635373232303734366632303665366636653230343535323433333733323331353236353630303038323031353237663633363536393736363537323230363936643730366336353664363536653734363537323030303030303030303030303030303030303030303030303030303036303230383230313532353035363562376634663737366536313632366336353361323036653635373732303666373736653635373232303639373332303734363836353230376136353732366632303631363030303832303135323766363436343732363537333733303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663435353234333337333233313361323037343732363136653733363636353732323036363732366636643230363936653633366637323732363536333734323036303030383230313532376636663737366536353732303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030363032303832303135323530353635623766343535323433333733323331336132303734366636623635366532303631366337323635363136343739323036643639366537343635363430303030303030303630303038323031353235303536356237663139303130303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303036303030383230313532353035363562376634353532343333373332333133613230373437323631366537333636363537323230373436663230373436383635323037613635373236663230363136343634363030303832303135323766373236353733373330303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663435353234333337333233313361323036313730373037323666373636353230373436663230363336313663366336353732303030303030303030303030303036303030383230313532353035363562376634353433343435333431336132303639366537363631366336393634323037333639363736653631373437353732363532303237373332373230373636313663363030303832303135323766373536353030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663433363836353633366237303666363936653734373333613230363236633666363336623230366536663734323037393635373432303664363936653635363436303030383230313532353035363562376634353532343333373332333133613230363136343634373236353733373332303761363537323666323036393733323036653666373432303631323037363631363030303832303135323766366336393634323036663737366536353732303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663536366637343635373333613230373336393637366536313734373537323635323036353738373036393732363536343030303030303030303030303030303036303030383230313532353035363562376634353532343333373332333135353532343935333734366637323631363736353361323035353532343932303733363537343230366636363230366536663665363030303832303135323766363537383639373337343635366537343230373436663662363536653030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663536366637343635373333613230363236633666363336623230366536663734323037393635373432303664363936653635363430303030303030303030303036303030383230313532353035363562376634353433343435333431336132303639366537363631366336393634323037333639363736653631373437353732363532303237373632373230373636313663363030303832303135323766373536353030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663435353234333337333233313361323036313730373037323666373636353230363336313663366336353732323036393733323036653666373432303734366636303030383230313532376636623635366532303666373736653635373232303665366637323230363137303730373236663736363536343230363636663732323036313663366330303030363032303832303135323530353635623766343535323433333733323331336132303664363936653734323037343666323037343638363532303761363537323666323036313634363437323635373337333630303038323031353235303536356237663466373736653631363236633635336132303633363136633663363537323230363937333230366536663734323037343638363532303666373736653635373236303030383230313532353035363562376635333631363636353433363137333734336132303736363136633735363532303634366636353733366532373734323036363639373432303639366532303332363030303832303135323766333233343230363236393734373330303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663435353234333337333233313361323036393665373636313663363936343230373436663662363536653230343934343030303030303030303030303030303036303030383230313532353035363562376634353532343333373332333133613230363137303730373236663736363136633230373436663230363337353732373236353665373432303666373736653635363030303832303135323766373230303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663465366632303631373636313663363136323663363532303631366436663735366537343230373436663230366436393665373432313030303030303030303036303030383230313532353035363562376635333631363636353433363137333734336132303736363136633735363532303634366636353733366532373734323036363639373432303639366532303333363030303832303135323766333232303632363937343733303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630323038323031353235303536356237663435353234333337333233313361323036333631366336633635373232303639373332303665366637343230373436663662363536653230366637373665363536303030383230313532376637323230366536663732323036313730373037323666373636353634303030303030303030303030303030303030303030303030303030303030303030303030363032303832303135323530353635623766326630303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303630303038323031353235303536356236313532373038313631343961353536356238313134363135323762353736303030383066643562353035363562363135323837383136313439623735363562383131343631353239323537363030303830666435623530353635623631353239653831363134396333353635623831313436313532613935373630303038306664356235303536356236313532623538313631343963643536356238313134363135326330353736303030383066643562353035363562363135326363383136313461313935363562383131343631353264373537363030303830666435623530353635623631353265333831363134613233353635623831313436313532656535373630303038306664356235303536666536383734373437303361326632663631373036393265363436313666363936653637326536313730373032663633366636643664373536653639373437393633366636633663363536333734363936663665326661323634363937303636373335383232313232306464656333653362303537363237343333373332376666326239653561353531333034333762386238356239383763303035356561363861366131306636663036343733366636633633343330303038303430303333222c2266726f6d223a22307832363438636645393765333333343533303044623831353436373033343762303836343335373062222c226761734c6576656c223a22222c226761734c696d6974223a223078346633653532222c226d6178466565506572476173223a223078633630326565323561222c226d61785072696f72697479466565506572476173223a2230783539363832663030222c226e6f6e6365223a22307830222c2272223a6e756c6c2c2273223a6e756c6c2c22746f223a6e756c6c2c2274797065223a22307832222c2276223a6e756c6c2c2276616c7565223a6e756c6c7d"
        val data = LegacyTransactionData(
            chainId = "0x1a4",
            from = "0x2648cfe97e33345300db8154670347b08643570b",
            to = "0x2a4e0Ba12F3A1d1b60Cb90C3776f6151cD00cf53",
            value = "0x38d7ea4c68000",
            data = "0x",
            nonce = "0x0",
            gasPrice = "0x59682f01",
            gasLimit = "0x5208",
            type = "0x0",
            action = "normal",
            gasLevel = "medium"
        )
        val trans1 =
            "{\"from\":\"0x2648cfe97e33345300db8154670347b08643570b\",\"data\":\"0x095ea7b300000000000000000000000041fdf02e0e2ca4a73217c09b2046fbe18751851effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\",\"gasPrice\":\"0x12a05f200\",\"to\":\"0xe9e7cea3dedca5984780bafc599bd69add087d56\",\"type\":\"0x0\",\"value\":\"0x0\"}"
        val trans3 =
            "{\"data\":\"0xa4f7c6f900000000000000000000000000000000000000000000000000000000642654c000000000000000000000000000000000000000000000000000000000000001ff000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000\",\"to\":\"0xCF80b3165a22F56EF4466E9c6A276FBFf3CA8c17\",\"nonce\":\"0x5\",\"gasLimit\":\"0x16f4e\",\"gasPrice\":\"0x2540be400\",\"value\":\"0x5af3107a4000\",\"chainId\":\"0x61\",\"type\":\"0x0\",\"from\":\"0x6ad1a1Cc971DBAEB985BCaa592d8a846dF84ec3c\"}"
        val evmTransaction = EVMTransactionUtil.createTransactionWithJson(trans3)
        walletAccount.connectAdapter.signAndSendTransaction(
            walletAccount.account.publicAddress,
            transaction.encode(),
            object : TransactionCallback {
                override fun onTransaction(transactionId: String?) {
                    binding.result.text = transactionId ?: ""
                    toast("signAndSendTransaction success")
                }

                override fun onError(error: ConnectError) {

                    Log.e("signAndSendTransaction", error.message)
                    toast(error.message)
                }
            })
    }

    private suspend fun signTransaction() {
        val transaction = MockManger.mockCreateTransaction(walletAccount.account.publicAddress)
        binding.request.text = GsonUtils.toJson(transaction)
        binding.result.text = ""
        walletAccount.connectAdapter.signTransaction(
            walletAccount.account.publicAddress,
            transaction,
            object : SignCallback {
                override fun onSigned(signature: String) {
                    binding.result.text = signature
                    toast("signTransaction success")
                }

                override fun onError(error: ConnectError) {
                    toast(error.message)
                }
            })
    }

    private suspend fun signAllTransactions() {
//        val transactions = listOf(
//            MockManger.mockCreateTransaction(walletAccount.account.publicAddress),
//            MockManger.mockCreateTransaction(walletAccount.account.publicAddress)
//        )
//        binding.request.text = GsonUtils.toJson(transactions)
        val transactions = Array(1) {
            "3igAAYeQWiGxrTXP47oHcCqgbLeYt9uHEmzhR7ZXNfffL9kGxgoCpw4qsBwby6y7kCJC2JDRopPvFtqs4C377ygMb6z4rcodDfB5Qt1Wz6iTXBVGht462fGWcumarJx6J5tnMpzRN8DffZfwuaJFxuE9WSora2cXWWyRW2Ps7n2A5NGv2ULPMGumkzPaw3mUyLfDQDndrgxHPYaWzogMxWdwTQ76t44ZBBqhswoTx1KkqYku1tL1p2qnhtPZcS73czrBuhprqwLNSo5tP5ijRvUM8x9qeMhtUvsSZ9Le5y27GaGFHznB4ET85KfyujVtWbSWeHTRyDkzoR2EEHpfm6gw6DHj9o7f72c5rWrtjaDe7CFdUuKYcJcQDWwHnKgn3A2s1iHnv4ZN4sm5HXuGNTYMdxuLZdbvZzmHN3Ai4dn2vVKFks7uYcv15AKnfj9mv2RLXSLkubrP5GCymPyhZ1HUxk7qjVHJFQ89w2q71fzvPmhnMU6vzTz2LTBoXttnTRWxBk818Pg1J2sUHaqKgvp77N9LGhf6aEE2d5XQ68dzRpm6NQRkRX4jF5oyDDWZ9x95q6WQTFeENdUZxPJFYy4WUqGqqRPMkphFbpDCPQAAKkmoNCbkehwPULMBQw3p4BRW7pQLs3cvDcPgxjtBUMQtkCqPNRAk7tvxPLM6EhcFYB9d9TV3BuQ9yxJvyorD9rCzyk8qCkCuNJc7S2NPsCDcMYDRSD8GhcMbjnuWdYwdcMj2xw6Gz5zB1rK9wGcAMJmefDFv89VoBDnktKVa4sWp9Y519YmpPRuN2CMaaiuwAqQyZJaeE5V7WZXZAMppNYntyevu4P4Ws2HPqG8wM49fuDf1au6ehhDRDrihTh3wdwouyVACEuAomjqMEYtYaSJMA6YChm6Y8vXposU4Svog7cCenpoHLY3rYPGaR5orqJS7rfNDmRLp8UKqQ4XLwdKkjoFXBPB9DeptAFstpRPGGsSpk4hqCAEy6Z59AJWaKfD51PcVaN88z53uwfhfoWTKAecqAx9u2YctpueWrD9KMscXxjLbNgz7USSN3CFCtBXERiawEEepgRPKHiUhejFfpECoXhMDR36TmBusQ5TZ4fyoffwQDpf1L3iNcxcVv23YXnHqgC3dJunJQmkajUYS9qMokjJUBTtwbi9ZUcTGDtAGwKmsvsDetwn3WYVhLVtmSPF33URKQ3zH7CKAVEEdmUfVEboDB3mv5CuV8aJ8f23qzuqA8qUDbF3MYNTYDgPyN2Z8vQStxKQSbtu3uvzuW6rPKHjSwvm6RmHziVPsrNqVabyean9Nx1Gdf1fN6BYSN9DcW9EoFaTb2ucFFwz3yFgVePzEjezLi346xYZDwuYH5unkFA8eczYwSVpy7rNy6uKMkWR4REVubeLuHnkMTYucGkjFoyP6JCow6P2xb7cv2YA5ngXeQ5xQ1enAnqgKMTjxDfRSX4Wj5sBPJhyZ47gTkuT5GKZYpo5DuJ8ksvB91hPq3U4YbvKmVrvdEp"
        }
        binding.result.text = ""
        walletAccount.connectAdapter.signAllTransactions(
            walletAccount.account.publicAddress,
            transactions,
            object : SignAllCallback {
                override fun onSigned(signatures: List<String>) {
                    binding.result.text = GsonUtils.toJson(signatures)
                    toast("signAllTransactions success")
                }

                override fun onError(error: ConnectError) {
                    toast(error.message)
                }
            })
    }

    private fun signMessage(message: String = "Hello Particle Connect!") {
        binding.request.text = message
        binding.result.text = ""
        walletAccount.connectAdapter.signMessage(
            walletAccount.account.publicAddress,
            MockManger.encode(message),
            object : SignCallback {
                override fun onSigned(signature: String) {
                    binding.result.text = signature
                    toast("signMessage success")
                    LogUtils.d(
                        "signMessage",
                        signature
                    )
                    if (ParticleConnect.chainType == ChainType.EVM) {
                        val address = Web3jSignatureVerifier.recoverAddressFromSignature(
                            signature,
                            message
                        )
                        LogUtils.d(
                            "recoverAddressFromSignature",
                            address,
                            walletAccount.account.publicAddress
                        )
                    }
                }

                override fun onError(error: ConnectError) {
                    LogUtils.d("signMessage", error.message)
                    toast(error.message)
                }
            })
    }

    private fun signTypedData() {
        val message = StreamUtils.getRawString(resources, R.raw.typed_data)
        binding.request.text = message
        binding.result.text = ""
        walletAccount.connectAdapter.signTypedData(
            walletAccount.account.publicAddress,
            MockManger.encode(message),
            object : SignCallback {
                override fun onSigned(signature: String) {
                    binding.result.text = signature
                    toast("signTypedData success")
                }

                override fun onError(error: ConnectError) {
                    toast(error.message)
                }
            })
    }

    private fun login(eip4361Message: Eip4361Message) {
        val message = eip4361Message.toString()
        binding.request.text = eip4361Message.toString()
        binding.result.text = ""
        walletAccount.connectAdapter.login(
            walletAccount.account.publicAddress,
            eip4361Message,
            object : SignCallback {
                override fun onSigned(signature: String) {
                    val result = walletAccount.connectAdapter.verify(
                        walletAccount.account.publicAddress,
                        signature,
                        message
                    )
                    val displayTxt = "signature:$signature\n\n verify:$result"
                    LogUtils.d("login verify", result)
                    binding.result.text = displayTxt
                }

                override fun onError(error: ConnectError) {
                    toast(error.message)
                }
            })
    }

    private fun createMessage(): Eip4361Message {
        // Message example from
        // evm-> https://eips.ethereum.org/EIPS/eip-4361
        // sol-> https://github.com/ChainAgnostic/CAIPs/blob/master/CAIPs/caip-74.md
        /*  val msg = Eip4361Message.fromString(
              """
              particle.network wants you to sign in with your Ethereum account:
              0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc21

              I accept the ServiceOrg Terms of Service: https://service.org/tos

              URI: https://service.org/login
              Version: 1
              Chain ID: 1
              Nonce: 32891756
              Issued At: 2021-09-30T16:25:24Z
              Resources:
              - ipfs://bafybeiemxf5abjwjbikoz4mc3a3dla6ual3jsgpdr4cjr3oz3evfyavhwq/
              - https://example.com/my-web2-claim.json
              """.trimIndent()
          )*/
        //you can use val msg = Eip4361Message("xx"...)
        val msg = Eip4361Message.createWithRequiredParameter(
            "particle.network",
            "https://service.org/login",
            "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc21"
        )
        return msg
    }


}